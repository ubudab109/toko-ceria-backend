import{r as y,j as e,c as I,z as L}from"./app-DVTrhL1p.js";import{B as z}from"./ButtonBack-9t6ATpas.js";import{u as B,S as f}from"./useSelectStyle-DAWAo9y5.js";import{P as w}from"./constant-CWNcz--l.js";import{s as H}from"./index-ikzcNs2d.js";import A from"./ModalStatusDescription-BRoifazi.js";import{P as S}from"./package-BG6wzjzp.js";import{L as u,T as E,S as G,C as K}from"./tag-CmG9tD2x.js";import{I as Q}from"./info-DAE2x8rJ.js";import{c as C}from"./createLucideIcon-CpnvUODs.js";import"./OrderStatusBadge-DHG_V-4H.js";import"./x-TECCxTS_.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}]],V=C("square-minus",Y);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],J=C("square-plus",W),m=({idHtmlFor:c,label:a,icon:d,errors:o,children:j,halfWidth:n=!1,isRequired:x=!1})=>e.jsxs("div",{className:n?"w-full md:w-1/2":"w-full",children:[e.jsxs("label",{htmlFor:String(c),className:"flex items-center mb-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[e.jsx(d,{className:"w-4 h-4 mr-2 text-blue-500"}),a," ",x&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),j,o&&e.jsx("p",{className:"mt-1 text-xs text-red-500 dark:text-red-400 font-medium",children:o})]});function ie({isEdit:c,data:a,setData:d,errors:o,handleSubmit:j,processing:n,customers:x,statuses:k,products:i,statusDescriptions:P}){const p=B({width:"100%"}),[$,N]=y.useState(!1),[q,v]=y.useState(!1),_=t=>`
        w-full p-3 text-sm rounded-lg transition-all duration-200
        bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white
        border ${o[t]?"border-red-500 ring-red-500":"border-gray-300 dark:border-gray-600 focus:border-blue-500 focus:ring-blue-500"}
        focus:ring-1 focus:outline-none
    `,O=()=>{const t=[...a.product_orders,{product_id:null,quantity:1,is_deleted:!1}];d("product_orders",t)},T=t=>{const s=[...a.product_orders],l=s[t];l.id?s[t]={...l,is_deleted:!0}:s.splice(t,1),d("product_orders",s)},M=(t,s)=>{const l=[...a.product_orders];t&&(l[s].product_id=typeof t.value=="string"?parseInt(t.value):t.value,d("product_orders",l))},R=(t,s)=>{const l=[...a.product_orders];l[t].quantity=s,d("product_orders",l)},h=y.useMemo(()=>a.product_orders.filter(t=>!t.is_deleted).reduce((t,s)=>{const l=i.find(b=>b.id===s.product_id);return t+(l?l.price*(s.quantity||1):0)},0),[a.product_orders,i]);return y.useEffect(()=>{d("total",h)},[h]),e.jsxs("div",{className:"w-full max-w-full p-6 sm:p-8 bg-white dark:bg-gray-800 shadow-2xl rounded-xl border border-gray-100 dark:border-gray-700 transition-all duration-300 mx-auto",children:[e.jsx(z,{}),e.jsxs("h1",{className:"flex items-center text-3xl font-extrabold text-gray-900 dark:text-white mb-6 border-b border-gray-200 dark:border-gray-700 pb-4",children:[e.jsx(S,{className:"w-8 h-8 mr-3 text-blue-600"}),c?"Edit Order":"Tambah Order Baru"]}),e.jsx(A,{isShow:q,statusDescriptions:P,onClose:()=>v(!1)},"status-description"),e.jsxs("form",{onSubmit:j,className:"space-y-8",encType:"multipart/form-data",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-800 dark:text-gray-100 flex items-center",children:[e.jsx(u,{className:"w-5 h-5 mr-2 text-gray-400"})," Detail Dasar"]}),e.jsxs(m,{isRequired:!0,id:"order_number",label:"Nomor Order",icon:E,errors:o.order_number,children:[e.jsx("input",{id:"name",type:"text",value:a.order_number,placeholder:"Klik generate nomor order secara otomatis",required:!0,readOnly:!0,className:_("order_number")}),e.jsx("button",{type:"button",className:"text-sm mt-1 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 dark:bg-blue-400 dark:hover:bg-blue-500",onClick:async()=>{N(!0);const t=await I.post(H("generate.order-number"));d("order_number",t.data.order_number),L.success(`Order Number berhasil dibuat: ${t.data.order_number}`),N(!1)},children:$?"Tunggu Sebentar...":"Generate Order Number Otomatis"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(m,{isRequired:!0,idHtmlFor:"customer_id",id:"customer_id",label:"Customer",icon:u,errors:o.customer_id,children:e.jsx(f,{id:"customer_id",options:x.map(t=>({label:`${t.fullname} - ${t.email}`,value:t.id})),onChange:t=>d("customer_id",t?.value??null),value:x.map(t=>({label:`${t.fullname} - ${t.email}`,value:t.id})).find(t=>t.value===a.customer_id)||null,styles:p,classNamePrefix:"react-select",placeholder:"Pilih Customer"})}),e.jsx(m,{isRequired:!0,idHtmlFor:"checkout_type",id:"checkout_type",label:"Tipe Checkout",icon:u,errors:o.checkout_type,children:e.jsx(f,{id:"checkout_type",options:w,onChange:t=>d("checkout_type",t?.value??null),value:w.map(t=>({label:`${t.label}`,value:t.value})).find(t=>t.value===a.checkout_type)||null,styles:p,classNamePrefix:"react-select",placeholder:"Pilih Tipe Checkout"})}),e.jsxs(m,{isRequired:!0,idHtmlFor:"status",id:"status",label:"Status Order",icon:u,errors:o.status,children:[e.jsx(f,{id:"status",options:k,onChange:t=>d("status",t?.value??null),value:k.map(t=>({label:`${t.label}`,value:t.value})).find(t=>t.value===a.status)||null,styles:p,classNamePrefix:"react-select",placeholder:"Pilih Order Status"}),e.jsxs("span",{onClick:()=>v(!0),className:"mt-2 cursor-pointer flex space-x-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[e.jsx(Q,{className:"mr-1"})," Klik disini untuk lihat deskripsi status"]})]})]}),e.jsx(m,{id:"notes",label:"Notes/Catatan Tambahan",icon:u,errors:o.notes,children:e.jsx("textarea",{id:"notes",value:a.notes||"",onChange:t=>d("notes",t.target.value),placeholder:"Catatan tambahan pada order...",rows:3,className:_("notes")+" resize-y"})})]}),e.jsxs("div",{className:"space-y-6 pt-4 border-t border-gray-100 dark:border-gray-700",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-800 dark:text-gray-100 flex items-center",children:[e.jsx(S,{className:"w-5 h-5 mr-2 text-gray-400"})," Produk"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("div",{className:"min-w-[950px] space-y-4",children:[o.product_orders&&e.jsx("p",{className:"mt-1 text-xs text-red-500 dark:text-red-400 font-medium",children:o.product_orders}),e.jsxs("div",{className:"flex justify-between font-semibold text-sm text-gray-600 dark:text-gray-300 border-b pb-1",children:[e.jsxs("span",{className:"w-[30%]",children:["Product ",e.jsx("span",{className:"text-xs text-red-500 dark:text-red-400 font-medium",children:"*"})]}),e.jsx("span",{className:"w-[15%] text-center",children:"Harga"}),e.jsxs("span",{className:"w-[15%] text-center",children:["Quantity ",e.jsx("span",{className:"text-xs text-red-500 dark:text-red-400 font-medium",children:"*"})]}),e.jsx("span",{className:"w-[20%] text-center",children:"Total"}),e.jsx("span",{className:"w-[20%] text-center",children:"Action"})]}),a.product_orders.filter(t=>!t.is_deleted).map((t,s)=>{const l=i.find(r=>r.id===t.product_id),b=l?.price&&t.quantity?l.price*t.quantity:0;return e.jsxs("div",{className:"flex items-center gap-4 border-b border-gray-200 dark:border-gray-700 pb-2",children:[e.jsxs("div",{className:"w-[30%]",children:[e.jsx(f,{id:`product_${s}`,options:i.filter(r=>!a.product_orders.some((g,F)=>g.product_id===r.id&&F!==s&&!g.is_deleted)).map(r=>({label:`${r.name} - Stok ${r.stock}`,value:r.id})),onChange:r=>M(r,s),value:t.product_id?(()=>{const r=i.find(g=>g.id===t.product_id);return r?{label:`${r.name} - Stok ${r.stock}`,value:r.id}:null})():null,styles:p,placeholder:"Pilih produk..."}),t.product_id&&i.find(r=>r.id===t.product_id)?.stock===0?e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Stok produk ini habis"}):null]}),e.jsx("div",{className:"w-[15%] text-center text-gray-800 dark:text-gray-200",children:l?`Rp ${l.price.toLocaleString()}`:"-"}),e.jsx("div",{className:"w-[15%] flex flex-col items-center",children:e.jsx("input",{type:"number",min:1,className:"w-20 text-center border rounded-md dark:bg-gray-700 dark:text-gray-100",value:t.quantity,disabled:!t.product_id||i.find(r=>r.id===t.product_id)?.stock===0,onChange:r=>R(s,parseInt(r.target.value)||1)})}),e.jsx("div",{className:"w-[20%] text-center text-gray-800 dark:text-gray-200",children:b>0?`Rp ${b.toLocaleString()}`:"-"}),e.jsxs("div",{className:"w-[10%] flex justify-center gap-2",children:[a.product_orders.length>1&&e.jsx("button",{type:"button",onClick:()=>T(s),className:"px-2 py-1 text-sm rounded bg-red-600 text-white hover:bg-red-700",children:e.jsx(V,{})}),s===a.product_orders.length-1&&e.jsx("button",{type:"button",onClick:O,className:"px-2 py-1 text-sm rounded bg-blue-600 text-white hover:bg-blue-700",children:e.jsx(J,{})})]})]},s)}),e.jsx("div",{className:"flex justify-end border-t border-gray-300 dark:border-gray-600 pt-3 mt-2",children:e.jsxs("div",{className:"text-right font-semibold text-gray-800 dark:text-gray-100",children:["Subtotal:Â ",e.jsxs("span",{className:"text-blue-600 dark:text-blue-400",children:["Rp ",h.toLocaleString()]}),e.jsx("input",{type:"hidden",name:"total",value:h})]})})]})})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100 dark:border-gray-700",children:e.jsxs("button",{type:"submit",disabled:n,className:`flex items-center px-6 py-2.5 text-base font-semibold rounded-lg text-white transition-all duration-300
                            bg-blue-600 hover:bg-blue-700 focus:ring-4 focus:outline-none focus:ring-blue-300
                            dark:bg-blue-700 dark:hover:bg-blue-800 dark:focus:ring-blue-900
                            disabled:opacity-60 disabled:cursor-not-allowed shadow-md hover:shadow-lg`,children:[n&&e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),!n&&(c?e.jsx(G,{className:"w-5 h-5 mr-2"}):e.jsx(K,{className:"w-5 h-5 mr-2"})),n?"Menyimpan...":c?"Simpan Perubahan Order":"Tambah Order"]})})]})]})}export{ie as default};
